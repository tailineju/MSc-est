---
title: "Resumo"
subtitle: "AnÃ¡lise de SobrevivÃªncia"
author: "Tailine J. S. Nonato"
date: today
date-format: long
format: pdf
---

# 1. DistribuiÃ§Ã£o Exponencial (com mÃ©dia $\lambda$)  
## FunÃ§Ãµes principais:  
$f(t) = \frac{1}{\lambda} e^{-\frac{t}{\lambda}}, \quad \text{para } t \geq 0$  

$S(t) = P(T > t) = e^{-\frac{t}{\lambda}}$  

$H(t) = \text{funÃ§Ã£o de risco acumulada} = -\ln(S(t)) = \frac{t}{\lambda}$  

$h(t) = \text{funÃ§Ã£o de risco instantÃ¢nea} = \frac{f(t)}{S(t)} = \frac{1}{\lambda} \quad (\text{constante})$  

$v(t) = \text{vida mÃ©dia residual} = \lambda \quad (\text{constante, propriedade da exponencial})$  

## Quantil de ordem $p$:  
$t_p = \lambda \cdot \left(-\ln(1 - p)\right)$  

## VariÃ¡vel discreta anÃ¡loga (segundo 2.29):  
Seja $T_d$ a v.a. discreta com $P(T_d = t) = S(t) - S(t+1)$. No caso da exponencial:  

$S(t) = e^{-\frac{t}{\lambda}} \implies P(T_d = t) = e^{-\frac{t}{\lambda}} \left(1 - e^{-\frac{1}{\lambda}}\right)$  

Isso Ã© a geomÃ©trica com parÃ¢metro $p = 1 - e^{-\frac{1}{\lambda}}$.  

# 2. EsperanÃ§a e momento de $T$ discreta com valores em $\mathbb{N}_0$  
Para qualquer v.a. discreta $T$ com suporte em $t = 0, 1, 2, \dots$:  

## FÃ³rmulas Ãºteis:  
$\mathbb{E}(T) = \sum_{t=0}^\infty S(t)$  

$\mathbb{E}(T^2) = \mathbb{E}(T) + 2 \sum_{t=1}^\infty t S(t)$  

Usa-se essas fÃ³rmulas quando a distribuiÃ§Ã£o Ã© dada via funÃ§Ã£o de sobrevivÃªncia.  

# 3. Quando a funÃ§Ã£o de risco Ã© dada (ex: $h(t) = 2t$)  
## Passos para encontrar a distribuiÃ§Ã£o:  
Calcula $H(t)$ (acumulada da funÃ§Ã£o de risco):  

$H(t) = \int_0^t h(u) \, du$  

FunÃ§Ã£o de sobrevivÃªncia:  

$S(t) = e^{-H(t)}$  

FunÃ§Ã£o densidade:  

$f(t) = h(t) \cdot S(t)$  

## Probabilidade de sobreviver mais de $a$ anos:  
$P(T > a) = S(a)$  

## Mediana:  
Resolver $S(m) = 0.5$ para encontrar o valor $m$.  

## Vida mÃ©dia residual:  
$v(t) = \frac{1}{S(t)} \int_t^{\infty} S(u) \, du$  

# 4. ComparaÃ§Ã£o de tratamentos via grÃ¡ficos de $S(t)$  
## Regras de interpretaÃ§Ã£o:  
Quanto mais rapidamente a curva de $S(t)$ decresce, menor a chance de sobrevivÃªncia.  

O melhor tratamento (mais eficiente para cura):  
Ã‰ o que tem menor $S(t)$ (maior probabilidade de cura) mais cedo.  

Para curar atÃ© tempo $t^*$:  
Prefira o tratamento com maior $P(T \leq t^*) = 1 - S(t^*)$.  

# 5. VariÃ¡vel discreta anÃ¡loga (segundo equaÃ§Ã£o 2.29)  
## Quando vocÃª tem uma v.a. contÃ­nua com $S(t)$:  
ConstrÃ³i a versÃ£o discreta $T_d \in \mathbb{N}_0$:  

FunÃ§Ã£o de probabilidade discreta:  

$P(T_d = t) = S(t) - S(t+1)$  

FunÃ§Ã£o de sobrevivÃªncia discreta:  

$S_d(t) = P(T_d > t) = S(t+1)$  

FunÃ§Ã£o de risco discreta:  

$h_d(t) = \frac{P(T_d = t)}{P(T_d \geq t)} = \frac{S(t) - S(t+1)}{S(t)}$  


# 6. FunÃ§Ãµes Fundamentais  
Dada uma variÃ¡vel aleatÃ³ria $T$, tempo atÃ© um evento:  

FunÃ§Ã£o de sobrevivÃªncia:  
$$S(t) = P(T > t)$$  

FunÃ§Ã£o de risco (hazard):  
$$h(t) = \frac{f(t)}{S(t)}$$  

FunÃ§Ã£o de risco acumulado (cumulative hazard):  
$$H(t) = \int_0^t h(u) \, du = -\ln(S(t))$$  

FunÃ§Ã£o vida mÃ©dia residual:  
$$\nu(t) = \mathbb{E}(T - t \mid T > t) = \frac{1}{S(t)} \int_t^{\infty} S(u) \, du$$  

# 7. Estimadores NÃ£o ParamÃ©tricos  

## Kaplan-Meier (KM)  
Define $S(t)$ com base em tempos ordenados de falha $t_1, t_2, \dots, t_k$:  
$$\hat{S}(t) = \prod_{t_i \leq t} \left( 1 - \frac{d_i}{n_i} \right)$$  
onde:  
- $d_i$: nÃºmero de eventos em $t_i$  
- $n_i$: nÃºmero de indivÃ­duos em risco logo antes de $t_i$  

## Nelson-Aalen (NA)  
Estimativa da funÃ§Ã£o de risco acumulado:  
$$\hat{H}(t) = \sum_{t_i \leq t} \frac{d_i}{n_i}, \quad \hat{S}(t) = \exp(-\hat{H}(t))$$  

# 8. Intervalos de ConfianÃ§a  

ðŸ“Ž Intervalo SimÃ©trico (KM):  
$$\hat{S}(t) \pm z_{\alpha/2} \sqrt{\widehat{\text{Var}}(\hat{S}(t))}$$  

ðŸ“Ž Intervalo via log-log:  
$$IC: \left[ \exp\left(-\exp\left(\log[-\log \hat{S}(t)] \pm z_{\alpha/2} \sqrt{\widehat{\text{Var}}(U(t))}\right)\right)\right]$$  
com $U(t) = \log[-\log \hat{S}(t)]$.  

ðŸ“Ž Intervalo para $H(t)$:  
$$IC_H(t) = \hat{H}(t) \pm z_{\alpha/2} \sqrt{\widehat{\text{Var}}(\hat{H}(t))}$$  

# 9. Quantis e EsperanÃ§a  

Quantil $p$ de $T$:  
Resolva $S(t_p) = 1 - p$.  

EsperanÃ§a (Exponencial):  
$$\mathbb{E}(T) = \lambda$$  

Para discretas:  
$$\mathbb{E}(T) = \sum_{t=0}^\infty S(t)$$  
$$\mathbb{E}(T^2) = \mathbb{E}(T) + 2 \sum_{t=1}^\infty t S(t)$$  

# 10. DistribuiÃ§Ã£o Discreta AnÃ¡loga (FÃ³rmula 2.29)  

Para $T$ contÃ­nua com $S(t)$, define-se uma v.a. discreta $T^*$ com:  
$$P(T^* = t) = S(t) - S(t+1)$$  
$$S^*(t) = S(\lfloor t \rfloor)$$  
$$h^*(t) = \frac{P(T^* = t)}{S^*(t)}$$  

Para Exponencial(\(\lambda\)), $T^* \sim \text{Geom}(p)$, onde $p = 1 - e^{-1/\lambda}$.  


# 11. ComparaÃ§Ã£o de Grupos (R)

```{r}	
#| eval: false
pacman::p_load(survival)
```

ðŸ“Š Logrank Test
```{r}
#| eval: false
survdiff(Surv(tempo, status) ~ grupo, data = dados)
```

ðŸ“Š Harrington-Fleming (G-rho family)

```{r}
#| eval: false
survdiff(Surv(tempo, status) ~ grupo, data = dados, rho = 1)
```

ðŸ“Š ComparaÃ§Ãµes MÃºltiplas (ex: post-hoc logrank)
Pairwise logrank com correÃ§Ã£o de Bonferroni:

```{r}
#| eval: false
pairwise_survdiff(Surv(tempo, status) ~ grupo, data = dados, p.adjust.method = "bonferroni")
```


# 12. Estimativas no R com KM e NA
```{r}
#| eval: false
fit_km <- survfit(Surv(tempo, status) ~ grupo, data = dados)
summary(fit_km)

fit_na <- survfit(Surv(tempo, status) ~ 1, data = dados, type = "fh") # Nelson-Aalen
```

```{r}
sample(c(1:33),1)
```